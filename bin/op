#!/usr/bin/env python3.4
import os.path
import sys
import magic
import mimetypes as mt
from subprocess import call
import subprocess as sb

def check_arg(arg):
    if os.path.isfile(arg[1]):
        return True
    elif "-h" in arg[1] or "help" in arg[1]:
        print("Just type this command with the file you want to open.\n")
        return False
    elif "-p" in arg[1] and os.path.isfile(arg[2]):
        mime_t = str(magic.from_file(arg[2], mime=True).strip())
        print(mime_t)
        return False
    else:
        return False

def check_extension_and_open(path):
    mime_t = str(magic.from_file(path, mime=True).strip())
    if "pdf" in mime_t : 
        call(["evince", path], stdout=sb.DEVNULL, stderr=sb.DEVNULL)
    elif "image" in mime_t:
        call(["eog", path], stdout=sb.DEVNULL, stderr=sb.DEVNULL)
    elif "zip" in mime_t or "tar" in mime_t or "rar" in mime_t:
        call(["file-roller", path], stdout=sb.DEVNULL, stderr=sb.DEVNULL)
    elif "text" in mime_t:
        call(["subl", path])
    elif "audio" in mime_t or "video" in mime_t:
        call(["mplayer", path])
    elif "torrent" in mime_t:
        call(["transmission-gtk", path], stdout=sb.DEVNULL, stderr=sb.DEVNULL)
    else:
        print("No configuration for this file. Please, add support for this file in the op script.\n")

def main():
    ext = ''
    path = sys.argv
    if check_arg(path):
        check_extension_and_open(path)

if __name__ == '__main__':
    main()
